# üöÄ D·ª± √°n SONDAIMINH

## üß© T·ªïng quan

H·ªá th·ªëng qu·∫£n l√Ω b√°n s∆°n v√† thi c√¥ng ch·ªëng th·∫•m, g·ªìm:
- Qu·∫£n l√Ω s·∫£n ph·∫©m, thu·ªôc t√≠nh, bi·∫øn th·ªÉ
- T√≠ch h·ª£p MinIO ƒë·ªÉ l∆∞u tr·ªØ media (·∫£nh/video)
- K·∫øt n·ªëi SQL Server qua Docker
- H·ªá th·ªëng ƒë∆∞·ª£c container h√≥a ho√†n to√†n b·∫±ng Docker

---

## ‚öôÔ∏è C·∫•u tr√∫c Docker Compose

```bash
docker-compose.db.yml         # Ch·∫°y SQL Server
docker-compose.minio.yml      # Ch·∫°y MinIO object storage
docker-compose.web.yml        # Ch·∫°y ASP.NET Web Application
```

---

## üõ†Ô∏è Setup ƒë·ªÉ ch·∫°y d·ª± √°n

### 1. Clone d·ª± √°n v√† c·∫•u h√¨nh file

```bash
git clone https://github.com/hunlorvike/daiminh daiminh
cd daiminh
```

### 2. T·∫°o file c·∫•u h√¨nh m√¥i tr∆∞·ªùng

- appsettings.json
- appsettings.Development.json
- appsettings.Production.json

> ƒê√£ c√≥ s·∫µn c√°c file m·∫´u.

### 3. Ch·∫°y MinIO v√† SQL Server

```bash
docker compose -f docker-compose.db.yml up -d
docker compose -f docker-compose.minio.yml up -d
```

### 4. Build image v√† ƒë·∫©y l√™n Docker Hub

```bash
docker build -t hungcutedethuongg/daiminh-web:latest .
docker push hungcutedethuongg/daiminh-web:latest
```

### 5. Tr√™n server, pull v√† ch·∫°y web

```bash
docker compose -f docker-compose.web.yml pull
docker compose -f docker-compose.web.yml up -d
```

---

## üß± C√¢u l·ªánh Entity Framework Core

1.  **Th√™m m·ªôt Migration:**
    T·∫°o m·ªôt t·ªáp migration m·ªõi ghi l·∫°i c√°c thay ƒë·ªïi.
    ```bash
    dotnet ef migrations add <T√™nMigrationC·ªßaB·∫°n> --project ./src/infrastructure/infrastructure.csproj --startup-project ./src/web/web.csproj
    ```

2.  **√Åp d·ª•ng Migration:**
    √Åp d·ª•ng c√°c migration ƒëang ch·ªù x·ª≠ l√Ω v√†o c∆° s·ªü d·ªØ li·ªáu.
    ```bash
    dotnet ef database update --project ./src/infrastructure/infrastructure.csproj --startup-project ./src/web/web.csproj
    ```

3.  **X√≥a Migration Cu·ªëi c√πng (n·∫øu c·∫ßn):**
    ```bash
    dotnet ef migrations remove --project ./src/infrastructure/infrastructure.csproj --startup-project ./src/web/web.csproj
    ```

### C·∫•u h√¨nh EF n·∫øu ch∆∞a c√≥

C√†i tool:
```bash
dotnet tool install --global dotnet-ef
```

Th√™m `ItemGroup` trong `.csproj` n·∫øu c·∫ßn:

```xml
<ItemGroup>
  <DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.DotNet" Version="8.0.0" />
</ItemGroup>
```

---

## üß† Ghi ch√∫

- M√¥i tr∆∞·ªùng production s·ª≠ d·ª•ng domain: `cdn.yourdomain.com` proxy v·ªÅ `minio`
- ASP.NET Core s·ª≠ d·ª•ng `ASPNETCORE_ENVIRONMENT=Production` trong docker-compose