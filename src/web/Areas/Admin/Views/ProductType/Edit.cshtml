@using web.Areas.Admin.ViewModels.ProductType
@model ProductTypeViewModel
@{
	ViewData["Title"] = "Chỉnh sửa loại sản phẩm - Hệ thống quản trị";
}

<div class="row g-4">
	<div class="col-lg-8">
		<form asp-action="Edit" asp-route-id="@Model.Id" method="post">
			<div class="card">
				<div class="card-header">
					<h3 class="card-title">Thông tin loại sản phẩm</h3>
				</div>
				<div class="card-body">
					<div asp-validation-summary="ModelOnly" class="text-danger alert alert-danger mb-3"></div>
					<input type="hidden" asp-for="Id" />
					@Html.AntiForgeryToken()

					<partial name="_ProductTypeFormFields" model="Model" />
				</div>
				<div class="card-footer text-end bg-transparent border-top pt-3">
					<a asp-action="Index" class="btn btn-link">Hủy</a>
					<button type="submit" class="btn btn-primary ms-2">
						<i class="ti ti-device-floppy me-2"></i> Cập nhật
					</button>
				</div>
			</div>
		</form>
	</div>

	<div class="col-lg-4">
		<div class="card sticky-top">
			<div class="card-header">
				<h3 class="card-title">Ví dụ Tabler Icons</h3>
			</div>
			<div class="card-body">
				<p class="mb-2">Nhấn để chọn:</p>
				<div class="row row-cols-4 g-2 mb-3">
					<div class="col text-center">
						<button type="button" class="btn btn-icon btn-outline-secondary icon-btn" data-icon="ti ti-package" title="ti ti-package">
							<i class="ti ti-package fs-2"></i>
						</button>
					</div>
					<div class="col text-center">
						<button type="button" class="btn btn-icon btn-outline-secondary icon-btn" data-icon="ti ti-building-store" title="ti ti-building-store">
							<i class="ti ti-building-store fs-2"></i>
						</button>
					</div>
					<div class="col text-center">
						<button type="button" class="btn btn-icon btn-outline-secondary icon-btn" data-icon="ti ti-tools" title="ti ti-tools">
							<i class="ti ti-tools fs-2"></i>
						</button>
					</div>
					<div class="col text-center">
						<button type="button" class="btn btn-icon btn-outline-secondary icon-btn" data-icon="ti ti-paint" title="ti ti-paint">
							<i class="ti ti-paint fs-2"></i>
						</button>
					</div>
					<div class="col text-center">
						<button type="button" class="btn btn-icon btn-outline-secondary icon-btn" data-icon="ti ti-settings" title="ti ti-settings">
							<i class="ti ti-settings fs-2"></i>
						</button>
					</div>
					<div class="col text-center">
						<button type="button" class="btn btn-icon btn-outline-secondary icon-btn" data-icon="ti ti-device-laptop" title="ti ti-device-laptop">
							<i class="ti ti-device-laptop fs-2"></i>
						</button>
					</div>
					<div class="col text-center">
						<button type="button" class="btn btn-icon btn-outline-secondary icon-btn" data-icon="ti ti-hanger" title="ti ti-hanger">
							<i class="ti ti-hanger fs-2"></i>
						</button>
					</div>
					<div class="col text-center">
						<button type="button" class="btn btn-icon btn-outline-secondary icon-btn" data-icon="ti ti-home-2" title="ti ti-home-2">
							<i class="ti ti-home-2 fs-2"></i>
						</button>
					</div>
				</div>
				<p class="small text-muted mb-0">Xem danh sách đầy đủ tại <a href="https://tabler-icons.io/" target="_blank" rel="noopener">tabler-icons.io</a></p>
			</div>
		</div>
	</div>
</div>

@section Scripts {
	<script src="~/js/slug.js" asp-append-version="true"></script>
	<script>
		$(document).ready(function() {
			const nameInput = $('#Name');
			const slugInput = $('#Slug');
			const generateBtn = $('#generateSlugButton');
			let userModifiedSlug = slugInput.val() !== '' && slugInput.val() !== generateVietnameseSlug(nameInput.val());

			slugInput.on('input', function() { userModifiedSlug = true; });

			nameInput.on('input', function() {
				if (!userModifiedSlug) {
					try { slugInput.val(generateVietnameseSlug(nameInput.val())); }
					catch(e) { console.error("Slug generation error:", e); }
				}
			});
			generateBtn.on('click', function() {
				userModifiedSlug = false; 
				try { slugInput.val(generateVietnameseSlug(nameInput.val())); }
				catch(e) { console.error("Slug generation error:", e); }
			});

			const iconInput = $('#Icon');
			const iconPreview = $('#iconPreview');
			const defaultIcon = 'ti ti-package';

			iconInput.on('input', function() {
				var iconClass = $(this).val().trim();
				if (iconClass && iconClass.startsWith('ti ti-')) {
					iconPreview.attr('class', iconClass);
				} else {
					iconPreview.attr('class', defaultIcon);
				}
			}).trigger('input'); 

			$('.icon-btn').on('click', function() {
				var iconClass = $(this).data('icon');
				iconInput.val(iconClass).trigger('input');
			});
		});
	</script>
}