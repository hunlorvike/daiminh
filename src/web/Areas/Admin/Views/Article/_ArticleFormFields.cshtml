@using shared.Helpers;
@using web.Areas.Admin.ViewModels.Article;
@model ArticleViewModel;
@using shared.Enums;
@using shared.Extensions;

@* --- TABS --- *@
<ul class="nav nav-tabs nav-fill mb-3" data-bs-toggle="tabs" role="tablist">
    <li class="nav-item" role="presentation"><a href="#article-tab-content" class="nav-link active" data-bs-toggle="tab" aria-selected="true" role="tab"><i class="ti ti-file-text me-2"></i> Nội dung chính</a></li>
    <li class="nav-item" role="presentation"><a href="#article-tab-images" class="nav-link" data-bs-toggle="tab" aria-selected="false" role="tab" tabindex="-1"><i class="ti ti-photo me-2"></i> Hình ảnh & Tác giả</a></li>
    <li class="nav-item" role="presentation"><a href="#article-tab-relations" class="nav-link" data-bs-toggle="tab" aria-selected="false" role="tab" tabindex="-1"><i class="ti ti-tags me-2"></i> Phân loại & Liên kết</a></li>
    <li class="nav-item" role="presentation"><a href="#article-tab-publishing" class="nav-link" data-bs-toggle="tab" aria-selected="false" role="tab" tabindex="-1"><i class="ti ti-calendar-event me-2"></i> Xuất bản</a></li>
    <li class="nav-item" role="presentation"><a href="#article-tab-seo" class="nav-link" data-bs-toggle="tab" aria-selected="false" role="tab" tabindex="-1"><i class="ti ti-search me-2"></i> Tối ưu SEO</a></li>
</ul>

@* --- TAB CONTENT --- *@
<div class="tab-content">
    @* --- Tab: Content --- *@
    <div class="tab-pane active show" id="article-tab-content" role="tabpanel">
        <div class="mb-3"><label asp-for="Title" class="form-label required"></label><input asp-for="Title" class="form-control form-control-lg" id="articleTitle" /><span asp-validation-for="Title" class="text-danger"></span></div>
        <div class="mb-3"><label asp-for="Slug" class="form-label required"></label><div class="input-group"><input asp-for="Slug" class="form-control" id="articleSlug" /><button class="btn btn-outline-secondary" type="button" id="generateSlugButton"><i class="ti ti-refresh"></i></button></div><span asp-validation-for="Slug" class="text-danger"></span></div>
        <div class="mb-3"><label asp-for="Summary" class="form-label"></label><textarea asp-for="Summary" class="form-control" rows="3"></textarea><span asp-validation-for="Summary" class="text-danger"></span><small class="form-hint">Mô tả ngắn gọn cho bài viết (hiển thị ở danh sách).</small></div>
        <div class="mb-0"><label asp-for="Content" class="form-label required"></label><textarea asp-for="Content" class="form-control summernote-editor" id="articleContentEditor" rows="20"></textarea><span asp-validation-for="Content" class="text-danger"></span></div>
    </div>

    @* --- Tab: Images & Author --- *@
    <div class="tab-pane" id="article-tab-images" role="tabpanel">
        <div class="row">
            <div class="col-md-6">
                <h4 class="mb-3">Hình ảnh</h4>
                <div class="form-group mb-3" id="featured-image-area">
                    <label asp-for="FeaturedImage" class="form-label"></label>
                    <div><img id="featuredImagePreview" src="@MediaUrlHelper.GetMinioUrl(Model.FeaturedImage, "/img/placeholder.svg")" class="img-thumbnail mb-2" style="max-height: 200px; max-width: 100%; object-fit: contain; min-height: 100px; background-color: #f8f9fa;" /></div>
                    <input type="hidden" asp-for="FeaturedImage" id="featuredImagePathInput" />
                    <div><button type="button" class="btn btn-sm btn-outline-primary select-media-btn" data-target-input="#featuredImagePathInput" data-target-preview="#featuredImagePreview"><i class="ti ti-photo-search me-1"></i> Chọn ảnh Featured</button><button type="button" class="btn btn-sm btn-outline-danger remove-media-btn ms-2 @(string.IsNullOrEmpty(Model.FeaturedImage) ? "d-none" : "")" data-target-input="#featuredImagePathInput" data-target-preview="#featuredImagePreview" data-placeholder="/img/placeholder.svg"><i class="ti ti-x me-1"></i> Xóa</button></div>
                    <span asp-validation-for="FeaturedImage" class="text-danger"></span>
                </div>
                <div class="form-group mb-3" id="thumbnail-image-area">
                    <label asp-for="ThumbnailImage" class="form-label"></label>
                    <div><img id="thumbnailImagePreview" src="@MediaUrlHelper.GetMinioUrl(Model.ThumbnailImage, "/img/placeholder.svg")" class="img-thumbnail mb-2" style="max-height: 100px; max-width: 100%; object-fit: contain; min-height: 60px; background-color: #f8f9fa;" /></div>
                    <input type="hidden" asp-for="ThumbnailImage" id="thumbnailImagePathInput" />
                    <div><button type="button" class="btn btn-sm btn-outline-primary select-media-btn" data-target-input="#thumbnailImagePathInput" data-target-preview="#thumbnailImagePreview"><i class="ti ti-photo-search me-1"></i> Chọn ảnh Thumbnail</button><button type="button" class="btn btn-sm btn-outline-danger remove-media-btn ms-2 @(string.IsNullOrEmpty(Model.ThumbnailImage) ? "d-none" : "")" data-target-input="#thumbnailImagePathInput" data-target-preview="#thumbnailImagePreview" data-placeholder="/img/placeholder.svg"><i class="ti ti-x me-1"></i> Xóa</button></div>
                    <span asp-validation-for="ThumbnailImage" class="text-danger"></span>
                    <small class="form-hint">Nếu bỏ trống sẽ dùng ảnh Featured làm thumbnail.</small>
                </div>
            </div>
            <div class="col-md-6">
                <h4 class="mb-3">Thông tin tác giả</h4>
                <div class="form-group mb-3"><label asp-for="AuthorName" class="form-label"></label><input asp-for="AuthorName" class="form-control" /><span asp-validation-for="AuthorName" class="text-danger"></span><small class="form-hint">Tên hiển thị cùng bài viết.</small></div>
                <div class="form-group mb-3" id="author-avatar-area">
                    <label asp-for="AuthorAvatar" class="form-label"></label>
                    <div><img id="authorAvatarPreview" src="@MediaUrlHelper.GetMinioUrl(Model.AuthorAvatar, "/img/placeholder.svg")" class="avatar avatar-xl mb-2" /></div>
                    <input type="hidden" asp-for="AuthorAvatar" id="authorAvatarPathInput" />
                    <div><button type="button" class="btn btn-sm btn-outline-primary select-media-btn" data-target-input="#authorAvatarPathInput" data-target-preview="#authorAvatarPreview"><i class="ti ti-photo-search me-1"></i> Chọn Avatar</button><button type="button" class="btn btn-sm btn-outline-danger remove-media-btn ms-2 @(string.IsNullOrEmpty(Model.AuthorAvatar) ? "d-none" : "")" data-target-input="#authorAvatarPathInput" data-target-preview="#authorAvatarPreview" data-placeholder="/img/placeholder.svg"><i class="ti ti-x me-1"></i> Xóa</button></div>
                    <span asp-validation-for="AuthorAvatar" class="text-danger"></span>
                </div>
            </div>
        </div>
    </div>

    @* --- Tab: Relations --- *@
    <div class="tab-pane" id="article-tab-relations" role="tabpanel">
        <div class="row">
            <div class="col-md-6">
                <div class="form-group mb-3"><label asp-for="SelectedCategoryIds" class="form-label required"></label><select asp-for="SelectedCategoryIds" asp-items="@Model.CategoryList" class="form-select tom-select-multiple" multiple="multiple"></select><span asp-validation-for="SelectedCategoryIds" class="text-danger"></span><small class="form-hint">Chọn ít nhất một danh mục.</small></div>
            </div>
            <div class="col-md-6">
                <div class="form-group mb-3"><label asp-for="SelectedTagIds" class="form-label"></label><select asp-for="SelectedTagIds" asp-items="@Model.TagList" class="form-select tom-select-multiple" multiple="multiple" id="SelectedTagIds"></select><span asp-validation-for="SelectedTagIds" class="text-danger"></span><small class="form-hint">Chọn hoặc nhập thẻ mới.</small></div>
            </div>
            <div class="col-12">
                <div class="form-group mb-0"><label asp-for="SelectedProductIds" class="form-label"></label><select asp-for="SelectedProductIds" asp-items="@Model.ProductList" class="form-select tom-select-multiple" multiple="multiple" id="SelectedProductIds"></select><span asp-validation-for="SelectedProductIds" class="text-danger"></span><small class="form-hint">Chọn các sản phẩm được đề cập (nếu có).</small></div>
            </div>
        </div>
    </div>

    @* --- Tab: Publishing --- *@
    <div class="tab-pane" id="article-tab-publishing" role="tabpanel">
        <div class="row">
            <div class="col-md-6">
                <div class="form-group mb-3"><label asp-for="Status" class="form-label required"></label><select asp-for="Status" asp-items="@Model.StatusList" class="form-select tom-select-single"></select><span asp-validation-for="Status" class="text-danger"></span></div>
            </div>
            <div class="col-md-6">
                <div class="form-group mb-3"><label asp-for="PublishedAt" class="form-label"></label><input asp-for="PublishedAt" type="datetime-local" class="form-control" /><span asp-validation-for="PublishedAt" class="text-danger"></span><small class="form-hint">Để trống nếu là 'Bản nháp'. Nếu chọn 'Đã xuất bản' mà để trống thì sẽ xuất bản ngay.</small></div>
            </div>
            <div class="col-md-6">
                <div class="form-check form-switch mb-3"><input class="form-check-input" type="checkbox" asp-for="IsFeatured" role="switch" id="articleIsFeaturedSwitch"><label class="form-check-label" asp-for="IsFeatured"></label></div>
            </div>
            <div class="col-md-6">
                <div class="form-group mb-3"><label asp-for="EstimatedReadingMinutes" class="form-label"></label><input asp-for="EstimatedReadingMinutes" class="form-control" readonly disabled /><small class="form-hint">Tự động tính toán dựa trên nội dung.</small></div>
            </div>
        </div>
    </div>

    @* --- Tab: SEO --- *@
    <div class="tab-pane" id="article-tab-seo" role="tabpanel">
        <h3 class="card-title mb-3">Tối ưu SEO</h3>
        <div class="mb-3"><label asp-for="MetaTitle" class="form-label"></label><input asp-for="MetaTitle" class="form-control" /><span asp-validation-for="MetaTitle" class="text-danger"></span><small class="form-hint">Tiêu đề SEO (tối ưu < 60 ký tự).</small></div>
        <div class="mb-3"><label asp-for="MetaDescription" class="form-label"></label><textarea asp-for="MetaDescription" class="form-control" rows="3"></textarea><span asp-validation-for="MetaDescription" class="text-danger"></span><small class="form-hint">Mô tả SEO (tối ưu < 160 ký tự).</small></div>
        <div class="mb-3"><label asp-for="MetaKeywords" class="form-label"></label><input asp-for="MetaKeywords" class="form-control" /><span asp-validation-for="MetaKeywords" class="text-danger"></span><small class="form-hint">Từ khóa SEO (cách nhau bởi dấu phẩy).</small></div>
        <hr class="my-3" />
        <div class="mb-3"><label asp-for="CanonicalUrl" class="form-label"></label><input asp-for="CanonicalUrl" class="form-control" type="url" /><span asp-validation-for="CanonicalUrl" class="text-danger"></span><small class="form-hint">URL gốc nếu trùng nội dung.</small></div>
        <div class="row mb-3"><div class="col-auto"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" asp-for="NoIndex" role="switch" id="seoNoIndexSwitch"><label class="form-check-label" asp-for="NoIndex"></label></div><small class="form-hint d-block ms-4 ps-2">Ngăn index.</small></div><div class="col-auto"><div class="form-check form-switch"><input class="form-check-input" type="checkbox" asp-for="NoFollow" role="switch" id="seoNoFollowSwitch"><label class="form-check-label" asp-for="NoFollow"></label></div><small class="form-hint d-block ms-4 ps-2">Ngăn follow link.</small></div></div>
        <hr class="my-3" />
        <h4 class="mb-3">Open Graph (Mạng xã hội)</h4>
        <div class="mb-3"><label asp-for="OgTitle" class="form-label"></label><input asp-for="OgTitle" class="form-control" /><span asp-validation-for="OgTitle" class="text-danger"></span></div>
        <div class="mb-3"><label asp-for="OgDescription" class="form-label"></label><textarea asp-for="OgDescription" class="form-control" rows="2"></textarea><span asp-validation-for="OgDescription" class="text-danger"></span></div>
        <div class="mb-3">
            <label asp-for="OgImage" class="form-label"></label>
            <div class="input-group">
                <input type="text" asp-for="OgImage" class="form-control" id="ogImagePathInput" placeholder="Nhập URL hoặc chọn ảnh MinIO Path" /> @* Adjusted placeholder *@
                <button class="btn btn-outline-secondary select-media-btn" type="button" data-target-input="#ogImagePathInput" data-target-preview="#ogImagePreview" title="Chọn ảnh"><i class="ti ti-photo-search"></i></button>
                <button class="btn btn-outline-danger remove-media-btn @(string.IsNullOrEmpty(Model.OgImage) ? "d-none" : "")" type="button" data-target-input="#ogImagePathInput" data-target-preview="#ogImagePreview" data-placeholder="/img/placeholder.svg" title="Xóa"><i class="ti ti-x"></i></button>
            </div>
            <span asp-validation-for="OgImage" class="text-danger"></span>
            <img id="ogImagePreview" src="@(Model.OgImage?.StartsWith("http") ?? false ? Model.OgImage : MediaUrlHelper.GetMinioUrl(Model.OgImage, "/img/placeholder.svg"))" class="img-thumbnail mt-2" style="max-height: 80px; display: @(string.IsNullOrEmpty(Model.OgImage) ? "none" : "block");" />
            <small class="form-hint">Nhập URL hoặc MinIO Path. Ảnh tỷ lệ 1.91:1.</small>
        </div>
        <div class="mb-3"><label asp-for="OgType" class="form-label"></label><input asp-for="OgType" class="form-control" /><span asp-validation-for="OgType" class="text-danger"></span></div>
        <hr class="my-3" />
        @* Add Twitter Card fields similar to Open Graph *@
        <hr class="my-3" />
        <h4 class="mb-3">Dữ liệu cấu trúc & Sitemap</h4>
        <div class="mb-3"><label asp-for="SchemaMarkup" class="form-label"></label><textarea asp-for="SchemaMarkup" class="form-control" rows="5"></textarea><span asp-validation-for="SchemaMarkup" class="text-danger"></span><small class="form-hint">JSON-LD Schema.org.</small></div>
        <div class="mb-3"><label asp-for="BreadcrumbJson" class="form-label"></label><textarea asp-for="BreadcrumbJson" class="form-control" rows="3"></textarea><span asp-validation-for="BreadcrumbJson" class="text-danger"></span><small class="form-hint">JSON cho Breadcrumbs.</small></div>
        <div class="row">
            <div class="col-md-6"><div class="form-group mb-3"><label asp-for="SitemapPriority" class="form-label"></label><input type="number" asp-for="SitemapPriority" class="form-control" step="0.1" min="0.0" max="1.0" /><span asp-validation-for="SitemapPriority" class="text-danger"></span></div></div>
            <div class="col-md-6"><div class="form-group mb-3"><label asp-for="SitemapChangeFrequency" class="form-label required"></label><select asp-for="SitemapChangeFrequency" class="form-select tom-select-single"><option value="always">Always</option><option value="hourly">Hourly</option><option value="daily">Daily</option><option value="weekly">Weekly</option><option value="monthly">Monthly</option><option value="yearly">Yearly</option><option value="never">Never</option></select><span asp-validation-for="SitemapChangeFrequency" class="text-danger"></span></div></div>
        </div>
    </div>
</div>
@* --- END OF FILE _ArticleFormFields.txt --- *@