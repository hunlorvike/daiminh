@using web.Areas.Admin.ViewModels.Seo
@model IEnumerable<SeoSettingsListItemViewModel>
@{
	ViewData["Title"] = "Quản lý cài đặt SEO";
}

<div class="container-fluid">
	<div class="d-sm-flex align-items-center justify-content-between mb-4">
		<h1 class="h3 mb-0 text-gray-800">Quản lý cài đặt SEO</h1>
		<div>
			<a asp-action="Settings" class="btn btn-primary btn-sm">
				<i class="fas fa-cog fa-sm"></i> Cài đặt chung
			</a>
			<a asp-action="Create" class="btn btn-success btn-sm">
				<i class="fas fa-plus fa-sm"></i> Thêm cài đặt mới
			</a>
		</div>
	</div>

	@if (TempData["SuccessMessage"] != null)
	{
		<div class="alert alert-success alert-dismissible fade show" role="alert">
			@TempData["SuccessMessage"]
			<button type="button" class="close" data-dismiss="alert" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
	}

	<div class="card shadow mb-4">
		<div class="card-header py-3">
			<h6 class="m-0 font-weight-bold text-primary">Danh sách cài đặt SEO</h6>
		</div>
		<div class="card-body">
			<div class="table-responsive">
				<table class="table table-hover" width="100%" cellspacing="0">
					<thead class="thead-light">
						<tr>
							<th>@Html.DisplayNameFor(model => model.Key)</th>
							<th>@Html.DisplayNameFor(model => model.Value)</th>
							<th>@Html.DisplayNameFor(model => model.Description)</th>
							<th>@Html.DisplayNameFor(model => model.IsActive)</th>
							<th>@Html.DisplayNameFor(model => model.UpdatedAt)</th>
							<th>Thao tác</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var item in Model)
						{
							<tr>
								<td>@item.Key</td>
								<td>
									@if (item.Value != null && item.Value.Length > 50)
									{
										@(item.Value.Substring(0, 50) + "...")
									}
									else
									{
										@item.Value
									}
								</td>
								<td>@item.Description</td>
								<td>
									@if (item.IsActive)
									{
										<span class="badge badge-success">Kích hoạt</span>
									}
									else
									{
										<span class="badge badge-secondary">Không kích hoạt</span>
									}
								</td>
								<td>@(item.UpdatedAt?.ToString("dd/MM/yyyy HH:mm") ?? "-")</td>
								<td>
									<div class="btn-group">
										<a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-primary btn-sm">
											<i class="fas fa-edit"></i>
										</a>
										<button type="button" class="btn btn-danger btn-sm" data-toggle="modal" data-target="#deleteModal-@item.Id">
											<i class="fas fa-trash"></i>
										</button>
									</div>

									<!-- Delete Modal -->
									<div class="modal fade" id="deleteModal-@item.Id" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel-@item.Id" aria-hidden="true">
										<div class="modal-dialog" role="document">
											<div class="modal-content">
												<div class="modal-header">
													<h5 class="modal-title" id="deleteModalLabel-@item.Id">Xác nhận xóa</h5>
													<button type="button" class="close" data-dismiss="modal" aria-label="Close">
														<span aria-hidden="true">&times;</span>
													</button>
												</div>
												<div class="modal-body">
													Bạn có chắc chắn muốn xóa cài đặt SEO <strong>@item.Key</strong>?
												</div>
												<div class="modal-footer">
													<button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
													<form asp-action="Delete" asp-route-id="@item.Id" method="post">
														<button type="submit" class="btn btn-danger">Xóa</button>
													</form>
												</div>
											</div>
										</div>
									</div>
								</td>
							</tr>
						}
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

@section Scripts {
	<script>
		$(document).ready(function() {
			// Auto-dismiss alerts
			window.setTimeout(function() {
				$(".alert").fadeTo(500, 0).slideUp(500, function() {
					$(this).remove();
				});
			}, 4000);
		});
	</script>
}

